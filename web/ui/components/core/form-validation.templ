package core

// FormValidation provides Alpine.js patterns for inline form validation
// This file contains reusable validation patterns that can be copied
// directly into your Templ templates

// VALIDATION PATTERN 1: Single field with validation
// Copy this pattern for any input that needs validation:
//
// <div x-data="{
//   value: '',
//   error: '',
//   touched: false,
//   validate() {
//     this.touched = true;
//     if (!this.value) {
//       this.error = 'This field is required';
//       return false;
//     }
//     this.error = '';
//     return true;
//   }
// }">
//   <input
//     x-model="value"
//     @blur="validate()"
//     @input="touched && validate()"
//   />
//   <span x-show="error" x-text="error"></span>
// </div>

templ FormValidationRequiredExample() {
	<div class="space-y-4 p-6 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700">
		<h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">Required Field Validation</h3>
		<div
			x-data="{
				value: '',
				error: '',
				touched: false,
				validate() {
					this.touched = true;
					if (!this.value || this.value.trim() === '') {
						this.error = 'This field is required';
						return false;
					}
					this.error = '';
					return true;
				}
			}"
		>
			<label class="block text-sm font-medium text-slate-900 dark:text-slate-100 mb-2">
				Name
				<span class="text-red-600">*</span>
			</label>
			<input
				type="text"
				x-model="value"
				@blur="validate()"
				@input="touched && validate()"
				placeholder="Enter your name"
				class="w-full px-3 py-2 border rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
				:class="error ? 'border-red-500 dark:border-red-500' : 'border-slate-300 dark:border-slate-600'"
			/>
			<p x-show="error" x-cloak class="mt-1 text-xs text-red-600" x-text="error" role="alert"></p>
		</div>
	</div>
}

// VALIDATION PATTERN 2: Email validation
templ FormValidationEmailExample() {
	<div class="space-y-4 p-6 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700">
		<h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">Email Validation</h3>
		<div
			x-data="{
				email: '',
				error: '',
				touched: false,
				validateEmail() {
					this.touched = true;
					if (!this.email) {
						this.error = 'Email is required';
						return false;
					}
					const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
					if (!emailRegex.test(this.email)) {
						this.error = 'Please enter a valid email address';
						return false;
					}
					this.error = '';
					return true;
				}
			}"
		>
			<label class="block text-sm font-medium text-slate-900 dark:text-slate-100 mb-2">
				Email
				<span class="text-red-600">*</span>
			</label>
			<input
				type="email"
				x-model="email"
				@blur="validateEmail()"
				@input="touched && validateEmail()"
				placeholder="you@example.com"
				class="w-full px-3 py-2 border rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
				:class="error ? 'border-red-500 dark:border-red-500' : 'border-slate-300 dark:border-slate-600'"
			/>
			<p x-show="error" x-cloak class="mt-1 text-xs text-red-600" x-text="error" role="alert"></p>
		</div>
	</div>
}

// VALIDATION PATTERN 3: Number range validation
templ FormValidationNumberExample() {
	<div class="space-y-4 p-6 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700">
		<h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">Number Range Validation</h3>
		<div
			x-data="{
				age: '',
				error: '',
				touched: false,
				min: 18,
				max: 120,
				validateNumber() {
					this.touched = true;
					if (!this.age) {
						this.error = 'Age is required';
						return false;
					}
					const num = parseInt(this.age);
					if (isNaN(num)) {
						this.error = 'Please enter a valid number';
						return false;
					}
					if (num < this.min) {
						this.error = `Age must be at least ${this.min}`;
						return false;
					}
					if (num > this.max) {
						this.error = `Age must be no more than ${this.max}`;
						return false;
					}
					this.error = '';
					return true;
				}
			}"
		>
			<label class="block text-sm font-medium text-slate-900 dark:text-slate-100 mb-2">
				Age (18-120)
				<span class="text-red-600">*</span>
			</label>
			<input
				type="number"
				x-model="age"
				@blur="validateNumber()"
				@input="touched && validateNumber()"
				placeholder="Enter your age"
				min="18"
				max="120"
				class="w-full px-3 py-2 border rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
				:class="error ? 'border-red-500 dark:border-red-500' : 'border-slate-300 dark:border-slate-600'"
			/>
			<p x-show="error" x-cloak class="mt-1 text-xs text-red-600" x-text="error" role="alert"></p>
		</div>
	</div>
}

// VALIDATION PATTERN 4: Complete form with multiple validations
templ FormValidationCompleteExample() {
	<div
		x-data="{
			formData: {
				name: '',
				email: '',
				age: '',
				message: ''
			},
			errors: {
				name: '',
				email: '',
				age: '',
				message: ''
			},
			touched: {
				name: false,
				email: false,
				age: false,
				message: false
			},
			validateName() {
				this.touched.name = true;
				if (!this.formData.name || this.formData.name.trim() === '') {
					this.errors.name = 'Name is required';
					return false;
				}
				if (this.formData.name.length < 2) {
					this.errors.name = 'Name must be at least 2 characters';
					return false;
				}
				this.errors.name = '';
				return true;
			},
			validateEmail() {
				this.touched.email = true;
				if (!this.formData.email) {
					this.errors.email = 'Email is required';
					return false;
				}
				const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
				if (!emailRegex.test(this.formData.email)) {
					this.errors.email = 'Please enter a valid email address';
					return false;
				}
				this.errors.email = '';
				return true;
			},
			validateAge() {
				this.touched.age = true;
				if (!this.formData.age) {
					this.errors.age = 'Age is required';
					return false;
				}
				const age = parseInt(this.formData.age);
				if (isNaN(age) || age < 18 || age > 120) {
					this.errors.age = 'Age must be between 18 and 120';
					return false;
				}
				this.errors.age = '';
				return true;
			},
			validateMessage() {
				this.touched.message = true;
				if (!this.formData.message || this.formData.message.trim() === '') {
					this.errors.message = 'Message is required';
					return false;
				}
				if (this.formData.message.length < 10) {
					this.errors.message = 'Message must be at least 10 characters';
					return false;
				}
				this.errors.message = '';
				return true;
			},
			validateAll() {
				const isNameValid = this.validateName();
				const isEmailValid = this.validateEmail();
				const isAgeValid = this.validateAge();
				const isMessageValid = this.validateMessage();
				return isNameValid && isEmailValid && isAgeValid && isMessageValid;
			},
			submitForm() {
				if (this.validateAll()) {
					console.log('Form is valid:', this.formData);
					alert('Form submitted successfully!');
					return true;
				}
				alert('Please fix the errors before submitting');
				return false;
			}
		}"
		class="space-y-6 p-6 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700"
	>
		<h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">Complete Form Validation</h3>
		<form @submit.prevent="submitForm()" class="space-y-4">
			<!-- Name Field -->
			<div>
				<label class="block text-sm font-medium text-slate-900 dark:text-slate-100 mb-2">
					Name
					<span class="text-red-600">*</span>
				</label>
				<input
					type="text"
					x-model="formData.name"
					@blur="validateName()"
					@input="touched.name && validateName()"
					placeholder="Enter your name"
					class="w-full px-3 py-2 border rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
					:class="errors.name ? 'border-red-500' : 'border-slate-300 dark:border-slate-600'"
				/>
				<p x-show="errors.name" x-cloak class="mt-1 text-xs text-red-600" x-text="errors.name" role="alert"></p>
			</div>
			<!-- Email Field -->
			<div>
				<label class="block text-sm font-medium text-slate-900 dark:text-slate-100 mb-2">
					Email
					<span class="text-red-600">*</span>
				</label>
				<input
					type="email"
					x-model="formData.email"
					@blur="validateEmail()"
					@input="touched.email && validateEmail()"
					placeholder="you@example.com"
					class="w-full px-3 py-2 border rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
					:class="errors.email ? 'border-red-500' : 'border-slate-300 dark:border-slate-600'"
				/>
				<p x-show="errors.email" x-cloak class="mt-1 text-xs text-red-600" x-text="errors.email" role="alert"></p>
			</div>
			<!-- Age Field -->
			<div>
				<label class="block text-sm font-medium text-slate-900 dark:text-slate-100 mb-2">
					Age (18-120)
					<span class="text-red-600">*</span>
				</label>
				<input
					type="number"
					x-model="formData.age"
					@blur="validateAge()"
					@input="touched.age && validateAge()"
					placeholder="Enter your age"
					min="18"
					max="120"
					class="w-full px-3 py-2 border rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
					:class="errors.age ? 'border-red-500' : 'border-slate-300 dark:border-slate-600'"
				/>
				<p x-show="errors.age" x-cloak class="mt-1 text-xs text-red-600" x-text="errors.age" role="alert"></p>
			</div>
			<!-- Message Field -->
			<div>
				<label class="block text-sm font-medium text-slate-900 dark:text-slate-100 mb-2">
					Message (min 10 characters)
					<span class="text-red-600">*</span>
				</label>
				<textarea
					x-model="formData.message"
					@blur="validateMessage()"
					@input="touched.message && validateMessage()"
					placeholder="Enter your message"
					rows="4"
					class="w-full px-3 py-2 border rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
					:class="errors.message ? 'border-red-500' : 'border-slate-300 dark:border-slate-600'"
				></textarea>
				<p x-show="errors.message" x-cloak class="mt-1 text-xs text-red-600" x-text="errors.message" role="alert"></p>
			</div>
			<!-- Submit Button -->
			<button
				type="submit"
				class="w-full px-4 py-2 bg-slate-900 dark:bg-slate-700 text-white rounded-md hover:bg-slate-800 dark:hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2 transition-colors"
			>
				Submit Form
			</button>
		</form>
	</div>
}

// VALIDATION PATTERN 5: Custom validator pattern
// Use this for complex validation logic
templ FormValidationCustomExample() {
	<div class="space-y-4 p-6 bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700">
		<h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">Custom Password Validation</h3>
		<div
			x-data="{
				password: '',
				confirmPassword: '',
				errors: { password: '', confirmPassword: '' },
				touched: { password: false, confirmPassword: false },
				validatePassword() {
					this.touched.password = true;
					const checks = {
						length: this.password.length >= 8,
						uppercase: /[A-Z]/.test(this.password),
						lowercase: /[a-z]/.test(this.password),
						number: /[0-9]/.test(this.password),
						special: /[!@#$%^&*]/.test(this.password)
					};
					if (!checks.length) {
						this.errors.password = 'Password must be at least 8 characters';
						return false;
					}
					if (!checks.uppercase || !checks.lowercase) {
						this.errors.password = 'Password must contain uppercase and lowercase letters';
						return false;
					}
					if (!checks.number) {
						this.errors.password = 'Password must contain at least one number';
						return false;
					}
					if (!checks.special) {
						this.errors.password = 'Password must contain at least one special character (!@#$%^&*)';
						return false;
					}
					this.errors.password = '';
					return true;
				},
				validateConfirmPassword() {
					this.touched.confirmPassword = true;
					if (!this.confirmPassword) {
						this.errors.confirmPassword = 'Please confirm your password';
						return false;
					}
					if (this.password !== this.confirmPassword) {
						this.errors.confirmPassword = 'Passwords do not match';
						return false;
					}
					this.errors.confirmPassword = '';
					return true;
				}
			}"
		>
			<!-- Password Field -->
			<div>
				<label class="block text-sm font-medium text-slate-900 dark:text-slate-100 mb-2">
					Password
					<span class="text-red-600">*</span>
				</label>
				<input
					type="password"
					x-model="password"
					@blur="validatePassword(); touched.confirmPassword && validateConfirmPassword()"
					@input="touched.password && validatePassword(); touched.confirmPassword && validateConfirmPassword()"
					placeholder="Enter password"
					class="w-full px-3 py-2 border rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
					:class="errors.password ? 'border-red-500' : 'border-slate-300 dark:border-slate-600'"
				/>
				<p x-show="errors.password" x-cloak class="mt-1 text-xs text-red-600" x-text="errors.password" role="alert"></p>
			</div>
			<!-- Confirm Password Field -->
			<div>
				<label class="block text-sm font-medium text-slate-900 dark:text-slate-100 mb-2">
					Confirm Password
					<span class="text-red-600">*</span>
				</label>
				<input
					type="password"
					x-model="confirmPassword"
					@blur="validateConfirmPassword()"
					@input="touched.confirmPassword && validateConfirmPassword()"
					placeholder="Confirm password"
					class="w-full px-3 py-2 border rounded-md bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100"
					:class="errors.confirmPassword ? 'border-red-500' : 'border-slate-300 dark:border-slate-600'"
				/>
				<p x-show="errors.confirmPassword" x-cloak class="mt-1 text-xs text-red-600" x-text="errors.confirmPassword" role="alert"></p>
			</div>
		</div>
	</div>
}
